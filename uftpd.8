.\"
.\" Copyright (c) 2014  Joachim Nilsson <troglobit@gmail.com>
.\"
.\" Permission to use, copy, modify, and/or distribute this software for any
.\" purpose with or without fee is hereby granted, provided that the above
.\" copyright notice and this permission notice appear in all copies.
.\"
.\" THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
.\" WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
.\" ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
.\" WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
.\" ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
.\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
.\"
.Dd May 4, 2014
.Dt UFTPD 8
.Os "uFTPd (1.3)"
.Sh NAME
.Nm uftpd
.Nd
No nonsense TFTP/FTP Server
.Sh SYNOPSIS
.Nm uftpd
.Op Fl dfivV
.Op Fl l Ar LOGFILE
.Op Fl f Ar PORT
.Op Fl t Ar PORT
.Sh DESCRIPTION
.Nm uftpd
is a very simple TFTP and anonymous FTP server.  It listens on standard
Internet ports for each protocol, as defined in the system service
specification, unless other ports are given on the command line.  For
details, see
.Xr services 5 .
.Pp
Available options:
.Bl -tag -width Ds
.It Fl d
Enable developer debug messages.  When the syslog backend is usued, log
messages are written to the syslog using
.Nm LOG_FTP
.It Fl n
Run in foreground, do not detach from controlling terminal
.It Fl i
Inetd mode, take client connections from stdin
.It Fl l
Enable syslog backend, useful in combination with
.Fl n.
Use the optional
.Ar LOGFILE
argument to redirect logging to a file
.It Fl f
Enable FTP service.  Use the optional
.Ar PORT
argument to listen to a custom port
.It Fl t
Enable TFTP service.  Use the optional
.Ar PORT
argument to listen to a custom port
.El
.Pp
.Sh FTP
The file
.Pa /etc/nologin
can be used to disable FTP access.  If the file exists,
.Nm
displays it and exits.  If the file
.Pa /etc/ftpwelcome
exists,
.Nm
prints it before issuing the
.Dq ready
message.
If the file
.Pa /etc/motd
exists,
.Nm
prints it after a successful login.  If the file
.Pa .message
exists in a directory,
.Nm
prints it when that directory is entered.
.Pp
The FTP server currently supports the following requests.
The case of the requests is ignored.
.Bl -column "Request" -offset indent
.It Request Ta "Description"
.It CWD Ta "change working directory"
.It DELE Ta "delete a file"
.It LIST Ta "give list files in a directory" Pq Dq Li "ls -lgA"
.It MKD Ta "make a directory"
.It NOOP Ta "do nothing"
.It PASS Ta "specify password"
.It PASV Ta "prepare for server-to-server transfer"
.It PORT Ta "specify data connection port"
.It PWD Ta "print the current working directory"
.It QUIT Ta "terminate session"
.It RETR Ta "retrieve a file"
.It RMD Ta "remove a directory"
.It RNFR Ta "specify rename-from file name"
.It RNTO Ta "specify rename-to file name"
.It SIZE Ta "return size of file"
.It STOR Ta "store a file"
.It SYST Ta "show operating system type of server system"
.It TYPE Ta "specify data transfer" Em type
.It USER Ta "specify user name"
.El
.Pp
Remaining FTP requests, as specified in Internet RFC 959, are not
recognized at the moment.  Patches are welcome!
.Pp
.Sh TFTP
uftpd also supports TFTP, the Trivial File Transfer Protocol, which is
often used for net booting diskless devices, e.g., BOOTP and PXEBOOT.
.Pp
The TFTP server currently supports the following requests.
.Bl -column "Request" -offset indent
.It RRQ
.It ERROR
.It ACK
.El
.Pp
Support for WRQ and blocksize negotiation, according to RFC 2348, is
planned but not yet implemented.
.Pp
.Sh FILES
.Bl -tag -width /etc/ftpwelcome -compact
.It Pa /etc/ftpwelcome
FTP Welcome notice.
.It Pa /etc/motd
Message of the day, presented after successful FTP login.
.It Pa /etc/nologin
Displayed to user attempting to connect.  Access is refused if this
file exists.
.El
.Sh SEE ALSO
.Xr ftp 1 ,
.Xr syslogd 8
.Sh BUGS
Here be dragons.
